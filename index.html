<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Metadonnées -->
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="Arsène Brosy & Maltered" name="author">
    <meta content="Création, site, internet, web, design" name="keywords">
    <meta content="Creez vos sites web avec des pros a mini-prix" name="description">

    <!-- Titre -->
    <title>Devcastle - Création de site webs a mini-prix</title>

    <!-- CSS -->
    <link href="../css/fonts/fonts.css" rel="stylesheet">
    <link href="../css/main.css" rel="stylesheet">

</head>
<body>
<div class="Paiement">
    <div id="choixPaiement">
        <h2>Moyen de paiement</h2>
        <p>Séléctionnez un moyen de paiement</p>
        <div class="moyenPaiement">
            <div class="paypal" id="paypal">
                <div class="alignCard">
                    <img height="54" src="src/Icons/PaypalIcon.png" width="54"/>
                    <p>Paypal</p>
                </div>
            </div>
            <div class="bankCard" id="bankCard">
                <div class="alignCard">
                    <img height="32.31" src="src/Icons/MastercardIcon.png" width="52.14"/>
                    <p>Carte bancaire</p>
                </div>
            </div>
        </div>
        <input id="continueButton" type="submit" value="12321">
    </div>


    <script>
        paypal.addEventListener('click', (e) => {
            document.getElementById('paypal').style.backgroundColor = '#9AC7FF';
            document.getElementById('paypal').style.borderColor = '#57A2FF';

            document.getElementById('bankCard').style.backgroundColor = 'white';
            document.getElementById('bankCard').style.borderColor = '#cccccc';
        });

        bankCard.addEventListener('click', (e) => {
            document.getElementById('bankCard').style.backgroundColor = '#9AC7FF';
            document.getElementById('bankCard').style.borderColor = '#57A2FF';

            document.getElementById('paypal').style.backgroundColor = 'white';
            document.getElementById('paypal').style.borderColor = '#cccccc';
        });

        continueButton.addEventListener('click', (e) => {
            document.getElementById('choixPaiement').style.display = 'none';
            document.getElementById('cartePaiement').style.display = 'block';
        });

    </script>

    <div id="cartePaiement" class="cartePaiement">
        <div class="infoPers">
            <div class="nom">
                <p>Nom</p>
                <input type="text">
            </div>
            <div class="prenom">
                <p>Prénom</p>
                <input type="text">
            </div>
        </div>
        <div>
            <p>Numéro de carte</p>
            <input class="numCarte" type="text">
        </div>
        <div class="expirationCVV">
            <div class="expiration">
                <p>Expiration</p>
                <input type="text">
            </div>
            <div class="CVV">
                <p>CVV</p>
                <input type="text">
            </div>
        </div>
        <input id="payerButton" type="submit" value="payer">
    </div>

    <div class="achatList">
        <h2>Votre commande</h2>
        <hr>
        <div class="paiementSiteWeb">
            <p>Site web</p>
            <p><span class="chf">CHF </span><span id="sitePrix" class="prix">---</span></p>
        </div>
        <div class="paiementHebergeur">
            <p>Hebergement</p>
            <p><span class="trace-chf">CHF 60</span><span class="chf">CHF </span><span id="hebergPrix" class="prix">---</span></p>
        </div>
        <hr>
        <div id="suisseRemise" class="remiseSuisse">
            <p>Remise de 5% pour les suisses</p>
            <p><span class="chf">CHF </span><span id="suisseRemisePrix" class="prix">---</span></p>
        </div>
        <div id="firstCommande" class="remisePremiere">
            <p>Bonus de première commande</p>
            <p><span>CHF </span><span class="prix">-10</span></p>
        </div>
        <hr id="remiseSeparation">
        <div class="total">
            <p>Total</p>
            <p>CHF <span id="total">---</span></p>
        </div>
        <p class="arrondiText">Arrondi favorable pour vous</p>
    </div>
</div>


<script type="module">

    var prixTotal = 0;

    var sitePrix = 505.99;
    var hebergPrix = 50;

    var suisseRemisePrix = 0;
    var firstCommandePrix = 0;

    var firstCommande = true;
    var suisseRemise = true;

    window.addEventListener('load', function () {

        if (suisseRemise == false) {
            document.getElementById('suisseRemise').style.display = 'none';
        } else {
            suisseRemisePrix = Math.round((sitePrix + hebergPrix) / 100 * 5)
            document.getElementById('suisseRemisePrix').innerHTML = suisseRemisePrix;
        }

        if (firstCommande == false) {
            document.getElementById('firstCommande').style.display = 'none';
        } else {
            firstCommandePrix = 10;
        }

        if (firstCommande == false && suisseRemise == false) {
            document.getElementById('remiseSeparation').style.display = 'none';
        };

        document.getElementById('sitePrix').innerHTML = sitePrix;
        document.getElementById('hebergPrix').innerHTML = hebergPrix;

        prixTotal = sitePrix + hebergPrix - suisseRemisePrix - firstCommandePrix;
        document.getElementById('total').innerHTML = prixTotal;
    });

    import {initializeApp} from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
    import {getAuth} from "https://www.gstatic.com/firebasejs/9.19.1/firebase-auth.js";
    import {getDatabase, set, ref} from "https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDpxXNFrji99t8a6QTcKhCmgIdA0ibs_lk",
        authDomain: "webcastle-website.firebaseapp.com",
        databaseURL: "https://webcastle-website-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "webcastle-website",
        storageBucket: "webcastle-website.appspot.com",
        messagingSenderId: "274339465548",
        appId: "1:274339465548:web:927dd550601c84dffce7e9"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const database = getDatabase(app);


    payerButton.addEventListener('click', (e) => {

        const user = auth.currentUser;

        var numFacture = 1;

        var now = new Date();
        var date = now.getDate() + "." + (now.getMonth() + 1) + "." + now.getFullYear() ;

        set(ref(database, 'users/' + user.uid + "/" + "facturation/facture_" + numFacture ), {
            prix: prixTotal,
            date: date
        })

        set(ref(database, 'users/' + user.uid + "/" + "facturation"), {
            nombre_facture:
        })

    });

</script>

<footer>
    <div class="center">
        <p>En effectuant votre commande, vous acceptez nos <a href="">Termes d’utilisation</a></p>
    </div>
</footer>


</body>
</html>